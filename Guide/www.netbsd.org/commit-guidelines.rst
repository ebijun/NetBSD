NetBSDコミットガイドライン
--------------------------

以下は、**NetBSD Commit Guidelines**に基づき、ソースツリーへのコミットを行う際のプロジェクトの基準をまとめたものです。

1. コミット対象の制限

  * **慣れているコードのみをコミットする**:
      * コミットする予定のコードが適切であるか確信が持てない場合（例：問題報告で提出されたコードを採用する場合）、そのシステム部分に詳しい開発者にレビューを依頼してください。
      * プロジェクトに参加したばかりの場合は、スポンサーに確認してください。
  * **汚染されたコード（Tainted Code）をコミットしない**:
      * 自分で書いたものではないコードをコミットする場合、そのライセンスがNetBSDソースリポジトリへのインポートと自由な再配布を許可していることを二重に確認してください。
      * **大規模言語モデル（LLM）やCopilot**、**ChatGPT**などの技術によって生成されたコードは、汚染されたコードと推定され、**core**からの事前の書面による承認なしにコミットしてはなりません。
  * **外部ツリーからのコードをコミットしない**:
      * `cvs.NetBSD.org`からチェックアウトしたもの以外のツリーからチェックアウトされたコードをリポジトリにコミットしないでください。

2. 事前の承認レベル

変更が侵襲的（影響範囲が広い）であるほど、より高いレベルの事前の承認が必要です。


.. csv-table::

 変更の性質,必要とされる承認レベル
 明白な修正 (Obvious Fixes),事前の議論やレビューは不要。（「明白」の定義は「誰にも反対されない可能性が高い」修正）
 その他の修正 (Non-obvious Fixes), レビューが必要です。 
 （重要な）新機能の実装, 適切な技術メーリングリストでの事前の議論が必要です。  
 全く新しいパッケージの追加,メーリングリストでの事前の議論と`core`からの承認が必要です。

3. テストの義務

  * **テストしたコードのみをコミットする**:
      * 変更によって影響を受けるコードが、システムのツールでコンパイルおよび実行され、期待通りに動作することを確認してください。
      * マニュアルページを変更した場合は、`groff`/`nroff`が期待する形式のマニュアルページを作成することを確認してください。
  * **ブランチへのプルアップ**：
      * ブランチへのプルアップを要求する前に、それぞれのリリースブランチで変更をテストしてください。
      * `/usr/tests`内のすべての関連テスト、または理想的にはテストスイート全体を実行してください。
  * **リグレッションの防止**:
      * 長期的なリグレッション（ビルドの破損やテストの失敗）は容認されません。原因となった変更は、問題が対処されない場合、バックアウトされます。

4. コミットの構造

  * **同じ修正の一部であるコミットをまとめる**:
      * 50個の`Makefile`に影響する`make`変数の修正は、すべてをまとめて1つのコミットにするべきです。
  * **各コミットを個別のパッチ/修正/追加などに分ける**:
      * 1つのコミットで3つのバグを修正し、「いくつかのバグを修正」としてまとめるのは避けてください。1つを修正し、テストし、コミットし、次に進んでください。
  * **機能やバグ修正のパッチと、空白/レイアウトの更新を混ぜない**:
      * これらは別々に行ってください。機能修正と空白変更を混ぜると、トランクからブランチへのプルアップで問題が発生することがあります。

5. コミットログの記述

  * **変更の理由をコミットログに明確に文書化する**:
      * 何が変更されたか、**なぜ**変更されたかをある程度詳細に記述してください。
      * 「なぜ」に焦点を当てるべきです。6か月後にログを読み、差分を見る人にとって有益であることが目標です。
      * *悪い例*：「いくつかのものを修正した」または「cvs-1.10.0」
      * *良い例*：「`.for`ディレクティブの実行中のエラーで役立つ行番号を出力するようにした。」
  * **PR（問題報告）を修正した場合は文書化する**:
      * コミットメッセージで「`PR category/bug-id`」というテンプレートを使用すると、バグデータベースの該当する問題報告にも追記されます（例：`Closes PR bin/6666`）。
  * **レビューを受けた場合は文書化する**:
      * 「`Reviewed by <mrg>`」のように記述してください。
  * **適切なクレジットを与える**:
      * PRで提出されたコードをコミットする場合、「`Code submitted in PR lib/393939 by Joe Doe`」のように適切なクレジットを付与してください。
      * コミットメッセージがメーリングリストで公開されるため、PR提出者のメールアドレスの明記は避けるべきです。
      * 他のオープンソースプロジェクトからコードを採用した場合は、「`From FreeBSD`」のようにクレジットを付与してください。

6. 他の開発者のコミットを元に戻さない

  * 他の開発者のコミットに同意できない場合でも、**自分で元に戻さない**でください。
  * その開発者に連絡し、問題点を説明し、**その開発者自身**に変更をバックアウトしてもらうよう依頼してください。
  * 合意に至らない場合は、調停機関として**Core Team**（`<core@NetBSD.org>`）に連絡してください。


~~~~

出典: [NetBSD Commit Guidelines](https://www.netbsd.org/developers/commit-guidelines.html)

